package com.habitrpg.client.unmarshalling;


import com.habitrpg.client.resource.*;
import org.codehaus.jackson.map.ObjectMapper;
import org.junit.Test;

import java.io.IOException;
import java.util.Collection;
import java.util.Iterator;

import static org.fest.assertions.Assertions.assertThat;

public class UserTest {

    private String response = "{\"auth\":{\"local\":{\"username\":\"kaddath\",\"email\":\"julien.smadja@gmail.com\",\"salt\":\"f8f243f201\",\"hashed_password\":\"29b066352258840800858965e0d5e073eaf1a0c0\"},\"timestamps\":{\"created\":1373394899694,\"loggedin\":1374097074972}},\"balance\":0,\"dailyIds\":[\"6b135068-c1a1-43d8-9fa1-4d7efda2df9b\",\"e4209eee-9b22-4cf5-adf3-d6b9992fc16b\",\"5354befd-7e82-4210-8ffd-44c13a3b7b2e\",\"bddf09e3-784d-4a95-8cda-6709b694e37a\",\"bf27f3e2-a315-4765-a9c3-aa9b0fd939ea\",\"c5c0c35f-a850-4ddc-9cba-9057d50aadd4\",\"adb5c005-585e-4312-bf1d-432e9d1f6f60\",\"c7bcbefb-4396-42f7-b92f-aa057aca967c\"]," +
            "\"filters\":{}," +
            "\"flags\":{\"ads\":\"show\",\"customizationsNotification\":true,\"dropsEnabled\":true,\"itemsEnabled\":true,\"partyEnabled\":true},\"habitIds\":[\"4bfd013f-41f2-4f88-b72c-1a93036c4034\",\"638df483-f8e5-4f9f-a576-62af6951471b\",\"0dc6b10d-ca72-4325-8ece-918b27dfab78\",\"f1deaa31-e00d-4214-8049-c7c643f4d7b1\",\"2a24c069-483d-48b9-8a4c-80a7f7b22d3f\"]," +
            "\"history\":{\"todos\":[{\"date\":1373457008209,\"value\":-13},{\"date\":1373557619827,\"value\":-24.28552375089771},{\"date\":1373615215981,\"value\":-36.924974063384575},{\"date\":1373701273066,\"value\":-50.910222396071006},{\"date\":1373792923064,\"value\":-19.350361696176144},{\"date\":1373870037105,\"value\":-18.698159263936617},{\"date\":1373961068358,\"value\":-5.1842772859409365},{\"date\":1374045889766,\"value\":-15.26566842019485}],\"exp\":[{\"date\":1373457008209,\"value\":37.5},{\"date\":1373557619827,\"value\":105},{\"date\":1373615215981,\"value\":133.5},{\"date\":1373701273066,\"value\":170},{\"date\":1373792923064,\"value\":313.5},{\"date\":1373870037105,\"value\":399},{\"date\":1373961068358,\"value\":474},{\"date\":1374045889766,\"value\":538.5}]},\"invitations\":{\"party\":null,\"guilds\":[]}," +
            "\"items\":{\"armor\":0,\"eggs\":[" +
            "{" +
            "\"text\":\"Lion Cub\"," +
            "\"name\":\"LionCub\"," +
            "\"value\":3," +
            "\"notes\":\"Find a hatching potion to pour on this egg, and one day it will hatch into a loyal pet.\"}," +
            "{\"text\":\"Wolf\",\"name\":\"Wolf\",\"value\":3,\"notes\":\"Find a hatching potion to pour on this egg, and one day it will hatch into a loyal pet.\",\"type\":\"Egg\",\"dialog\":\"You've found a Wolf Egg! Find a hatching potion to pour on this egg, and one day it will hatch into a loyal pet.\"},{\"text\":\"Lion Cub\",\"name\":\"LionCub\",\"value\":3,\"notes\":\"Find a hatching potion to pour on this egg, and one day it will hatch into a loyal pet.\",\"type\":\"Egg\",\"dialog\":\"You've found a Lion Cub Egg! Find a hatching potion to pour on this egg, and one day it will hatch into a loyal pet.\"},{\"text\":\"Flying Pig\",\"name\":\"FlyingPig\",\"value\":3,\"notes\":\"Find a hatching potion to pour on this egg, and one day it will hatch into a loyal pet.\",\"type\":\"Egg\",\"dialog\":\"You've found a Flying Pig Egg! Find a hatching potion to pour on this egg, and one day it will hatch into a loyal pet.\"}],\"head\":0,\"lastDrop\":{\"date\":1374060986295,\"count\":3},\"pets\":[],\"shield\":\"1\",\"weapon\":\"2\"},\"lastCron\":1374045889766,\"preferences\":{\"gender\":\"m\",\"skin\":\"white\",\"hair\":\"black\",\"armorSet\":\"v1\",\"dayStart\":0,\"showHelm\":true},\"profile\":{\"imageUrl\":\"\",\"name\":\"Julien Smadja\",\"websites\":[\"http://www.neogeodb.com\"]},\"rewardIds\":[],\"stats\":{\"exp\":133.5,\"gp\":10.486665038101256,\"hp\":48.2,\"lvl\":4,\"toNextLevel\":180,\"maxHealth\":50},\"tags\":[]," +
            "\"tasks\":" +
            "{\"0dc6b10d-ca72-4325-8ece-918b27dfab78\":{\"down\":true,\"history\":[{\"date\":1373480976639,\"value\":1},{\"date\":1374002858957,\"value\":1.9747}],\"id\":\"0dc6b10d-ca72-4325-8ece-918b27dfab78\",\"text\":\"Aller au sport\",\"type\":\"habit\",\"up\":true,\"value\":1.9747},\"18188c1a-f91d-4cab-a9e1-5c7250c12002\":{\"completed\":false,\"id\":\"18188c1a-f91d-4cab-a9e1-5c7250c12002\",\"type\":\"todo\",\"text\":\"Bugs neogeodb\",\"notes\":\"\",\"value\":0,\"tags\":{}},\"196a06c8-7860-42fa-a6a5-575819292690\":{\"completed\":true,\"id\":\"196a06c8-7860-42fa-a6a5-575819292690\",\"notes\":\"\",\"priority\":\"!!\",\"tags\":{},\"text\":\"Finir Halo 3\",\"type\":\"todo\",\"value\":-3.0488181170434947},\"2180602f-055c-47f3-b7a7-e0b04a550f41\":{\"completed\":false,\"id\":\"2180602f-055c-47f3-b7a7-e0b04a550f41\",\"notes\":\"\",\"tags\":{},\"text\":\"Aero Fighters 2\",\"type\":\"todo\",\"value\":-3.079244230667636},\"2a24c069-483d-48b9-8a4c-80a7f7b22d3f\":{\"down\":true,\"history\":[{\"date\":1373919001148,\"value\":1},{\"date\":1374061011523,\"value\":1.9747}],\"id\":\"2a24c069-483d-48b9-8a4c-80a7f7b22d3f\",\"text\":\"Manger un plat pas calorique\",\"type\":\"habit\",\"up\":true,\"value\":1.9747},\"2c0014ad-b27e-4147-8a77-ca89a8e2d086\":{\"completed\":true,\"id\":\"2c0014ad-b27e-4147-8a77-ca89a8e2d086\",\"notes\":\"\",\"tags\":{},\"text\":\"Real Bout Fatal Fury Special\",\"type\":\"todo\",\"value\":0.025956704627064786},\"2c1f35b7-bb3a-4785-b362-b838e697d212\":{\"completed\":true,\"id\":\"2c1f35b7-bb3a-4785-b362-b838e697d212\",\"notes\":\"\",\"tags\":{},\"text\":\"Aller voir Mauléon\",\"type\":\"todo\",\"value\":0.025956704627064786},\"30ea1718-fde1-4529-bdef-de9c59a5f0bf\":{\"completed\":false,\"id\":\"30ea1718-fde1-4529-bdef-de9c59a5f0bf\",\"notes\":\"\",\"priority\":\"!!!\",\"tags\":{},\"text\":\"Karcheriser le balcon\",\"type\":\"todo\",\"value\":-8.812292068721371},\"3330c614-875d-4ec0-a77e-eb7721e0c61c\":{\"completed\":false,\"id\":\"3330c614-875d-4ec0-a77e-eb7721e0c61c\",\"type\":\"todo\",\"text\":\"Ajouter video ChallegerOfTheWorves\",\"notes\":\"\",\"value\":0,\"tags\":{}},\"4264ea64-f55b-4a48-82a3-ae89f174aa67\":{\"completed\":true,\"id\":\"4264ea64-f55b-4a48-82a3-ae89f174aa67\",\"type\":\"todo\",\"text\":\"Créer invit déj Benjamin\",\"notes\":\"\",\"value\":1,\"tags\":{}},\"4bfd013f-41f2-4f88-b72c-1a93036c4034\":{\"down\":true,\"history\":[{\"date\":1373708277052,\"value\":1},{\"date\":1373713382248,\"value\":1.9747},{\"date\":1374061016723,\"value\":2.9253562257358428}],\"id\":\"4bfd013f-41f2-4f88-b72c-1a93036c4034\",\"notes\":\"\",\"tags\":{},\"text\":\"Litière\",\"type\":\"habit\",\"up\":true,\"value\":2.9253562257358428},\"5354befd-7e82-4210-8ffd-44c13a3b7b2e\":{\"completed\":true,\"history\":[{\"date\":1374045889768,\"value\":1}],\"id\":\"5354befd-7e82-4210-8ffd-44c13a3b7b2e\",\"notes\":\"\",\"repeat\":{\"su\":true,\"m\":true,\"t\":true,\"w\":true,\"th\":true,\"f\":true,\"s\":true},\"streak\":2,\"tags\":{},\"text\":\"< 68 Kg\",\"type\":\"daily\",\"value\":1.9747},\"5605735d-de8a-4d45-8aa5-d9207ee12692\":{\"completed\":false,\"id\":\"5605735d-de8a-4d45-8aa5-d9207ee12692\",\"notes\":\"\",\"tags\":{},\"text\":\"King of Fighters '01\",\"type\":\"todo\",\"value\":-4.161348258391507},\"56f8260f-2abe-4936-a2d1-5e6fc3228863\":{\"completed\":false,\"id\":\"56f8260f-2abe-4936-a2d1-5e6fc3228863\",\"type\":\"todo\",\"text\":\"Prendre RDV dermato\",\"notes\":\"\",\"value\":0,\"tags\":{}},\"57f9b235-f074-452f-b171-870c382bf0c7\":{\"completed\":false,\"id\":\"57f9b235-f074-452f-b171-870c382bf0c7\",\"type\":\"todo\",\"text\":\"Prévoir déj Paali\",\"notes\":\"\",\"value\":0,\"tags\":{}},\"5a97b15e-d836-4384-983a-97fb59c0e3c0\":{\"completed\":true,\"id\":\"5a97b15e-d836-4384-983a-97fb59c0e3c0\",\"type\":\"todo\",\"text\":\"Real Bout Fatal Fury\",\"notes\":\"\",\"value\":1,\"tags\":{}},\"5d746132-6363-42b2-a414-490c39f576ac\":{\"completed\":false,\"id\":\"5d746132-6363-42b2-a414-490c39f576ac\",\"type\":\"todo\",\"text\":\"Prévoir déj Ludwine\",\"notes\":\"\",\"value\":0,\"tags\":{}},\"628f2374-9139-42ad-bfa9-b046527b6b36\":{\"completed\":true,\"id\":\"628f2374-9139-42ad-bfa9-b046527b6b36\",\"notes\":\"\",\"tags\":{},\"text\":\"Vendre ou donner la TV cathodique 55cm\",\"type\":\"todo\",\"value\":-3.0488181170434947},\"638df483-f8e5-4f9f-a576-62af6951471b\":{\"down\":true,\"history\":[{\"date\":1373708269889,\"value\":1},{\"date\":1373710547160,\"value\":1.9747},{\"date\":1373976493668,\"value\":2.9253562257358428}],\"id\":\"638df483-f8e5-4f9f-a576-62af6951471b\",\"notes\":\"\",\"tags\":{},\"text\":\"Descendre poubelle\",\"type\":\"habit\",\"up\":true,\"value\":2.9253562257358428},\"6b135068-c1a1-43d8-9fa1-4d7efda2df9b\":{\"completed\":true,\"history\":[{\"date\":1373870037114,\"value\":1},{\"date\":1373961068360,\"value\":1.9747},{\"date\":1374045889768,\"value\":2.9253562257358428}],\"id\":\"6b135068-c1a1-43d8-9fa1-4d7efda2df9b\",\"notes\":\"\",\"repeat\":{\"su\":false,\"m\":true,\"t\":true,\"w\":true,\"th\":true,\"f\":true,\"s\":false},\"streak\":4,\"tags\":{},\"text\":\"Se lever à 7h30\",\"type\":\"daily\",\"value\":3.853133245658556},\"72109429-9696-4788-83bf-0281536f0e87\":{\"completed\":true,\"id\":\"72109429-9696-4788-83bf-0281536f0e87\",\"text\":\"Remplir la feuille de soins\",\"type\":\"todo\",\"value\":-3.0488181170434947},\"78e33fae-839f-4293-b85f-3417a1120db5\":{\"completed\":true,\"id\":\"78e33fae-839f-4293-b85f-3417a1120db5\",\"type\":\"todo\",\"text\":\"Créer accès staffing ludwine\",\"notes\":\"\",\"value\":1,\"tags\":{}},\"7b2f0c9f-00fb-4788-a27e-d4cab21afdb7\":{\"completed\":true,\"id\":\"7b2f0c9f-00fb-4788-a27e-d4cab21afdb7\",\"notes\":\"\",\"tags\":{},\"text\":\"Prendre RDV chez Bouet le 18\",\"type\":\"todo\",\"value\":-5.239802699145147},\"86ea029c-68ee-4aa6-a3fe-e5277a2e952c\":{\"completed\":true,\"id\":\"86ea029c-68ee-4aa6-a3fe-e5277a2e952c\",\"text\":\"Prendre rendez vous coiffeur\",\"type\":\"todo\",\"value\":-3.0488181170434947},\"8da807e7-133b-44ae-8c65-8d1210e1fc83\":{\"completed\":true,\"id\":\"8da807e7-133b-44ae-8c65-8d1210e1fc83\",\"text\":\"Pneu clio 3\",\"type\":\"todo\",\"value\":0.025956704627064786},\"8e139638-ce8f-40ba-8d00-beff78fb9a54\":{\"completed\":false,\"id\":\"8e139638-ce8f-40ba-8d00-beff78fb9a54\",\"notes\":\"\",\"tags\":{},\"text\":\"King of Fighters '97\",\"type\":\"todo\",\"value\":-4.161348258391507},\"a03998ce-63f6-451a-ba89-15ec36cff717\":{\"completed\":false,\"id\":\"a03998ce-63f6-451a-ba89-15ec36cff717\",\"text\":\"Changer pile de ma montre\",\"type\":\"todo\",\"value\":-8.812292068721371},\"abf6c28c-4368-486c-b04f-9b87b3bb38f1\":{\"completed\":true,\"id\":\"abf6c28c-4368-486c-b04f-9b87b3bb38f1\",\"text\":\"Trier vide poche\",\"type\":\"todo\",\"value\":0.025956704627064786},\"adb5c005-585e-4312-bf1d-432e9d1f6f60\":{\"completed\":false,\"history\":[{\"date\":1373457008210,\"value\":1},{\"date\":1373557619829,\"value\":1.9747},{\"date\":1373615215983,\"value\":2.9253562257358428},{\"date\":1373701273067,\"value\":3.853133245658556},{\"date\":1373792923066,\"value\":4.779421276212302},{\"date\":1373870037115,\"value\":5.664149044631875},{\"date\":1373961068360,\"value\":6.529044256984443},{\"date\":1374045889768,\"value\":7.374981304009736}],\"id\":\"adb5c005-585e-4312-bf1d-432e9d1f6f60\",\"notes\":\"\",\"repeat\":{\"su\":true,\"m\":true,\"t\":true,\"w\":true,\"th\":true,\"f\":true,\"s\":true},\"streak\":8,\"tags\":{},\"text\":\"Creme le soir\",\"type\":\"daily\",\"value\":7.374981304009736},\"af292882-6971-456a-829a-8c4ec4c369c5\":{\"completed\":true,\"id\":\"af292882-6971-456a-829a-8c4ec4c369c5\",\"notes\":\"\",\"tags\":{},\"text\":\"Jeter le Dell XPS\",\"type\":\"todo\",\"value\":-3.0488181170434947},\"bddf09e3-784d-4a95-8cda-6709b694e37a\":{\"completed\":true,\"history\":[{\"date\":1373457008210,\"value\":-1},{\"date\":1373557619829,\"value\":0.025956704627064786},{\"date\":1373615215983,\"value\":-0.9733783617683589},{\"date\":1373701273068,\"value\":0.05187867997035989},{\"date\":1373792923066,\"value\":1.050550143672086},{\"date\":1373870037115,\"value\":2.0239883589663585},{\"date\":1373961068360,\"value\":2.9734446246898476},{\"date\":1374045889768,\"value\":2.046810192411606}],\"id\":\"bddf09e3-784d-4a95-8cda-6709b694e37a\",\"streak\":1,\"text\":\"Creme le matin\",\"type\":\"daily\",\"value\":2.995711357575025},\"beaa3751-04e8-4b0e-b9b3-df3f300afd15\":{\"completed\":true,\"id\":\"beaa3751-04e8-4b0e-b9b3-df3f300afd15\",\"notes\":\"\",\"priority\":\"!!\",\"tags\":{},\"text\":\"Ranger mon armoire\",\"type\":\"todo\",\"value\":-3.0488181170434947},\"bf27f3e2-a315-4765-a9c3-aa9b0fd939ea\":{\"completed\":true,\"history\":[{\"date\":1373457008210,\"value\":1},{\"date\":1373557619829,\"value\":1.9747},{\"date\":1373615215983,\"value\":2.9253562257358428},{\"date\":1373701273068,\"value\":3.853133245658556},{\"date\":1373792923066,\"value\":4.759112700885761},{\"date\":1373870037115,\"value\":5.6443010177121415},{\"date\":1373961068360,\"value\":6.5096362419810205},{\"date\":1374045889768,\"value\":7.355994112832055}],\"id\":\"bf27f3e2-a315-4765-a9c3-aa9b0fd939ea\",\"notes\":\"\",\"repeat\":{\"su\":true,\"m\":true,\"t\":true,\"w\":true,\"th\":true,\"f\":true,\"s\":true},\"streak\":9,\"tags\":{},\"text\":\"Effexor à midi\",\"type\":\"daily\",\"value\":8.184193475367},\"c5c0c35f-a850-4ddc-9cba-9057d50aadd4\":{\"completed\":true,\"history\":[{\"date\":1373457008211,\"value\":-1},{\"date\":1373557619829,\"value\":0.025956704627064786},{\"date\":1373615215983,\"value\":1.0252917710224885},{\"date\":1373701273068,\"value\":1.999360257529945},{\"date\":1373792923066,\"value\":2.949415922378421},{\"date\":1373870037119,\"value\":2.949415922378421},{\"date\":1373961068360,\"value\":3.87662110426386},{\"date\":1374045889768,\"value\":4.7820554242776065}],\"id\":\"c5c0c35f-a850-4ddc-9cba-9057d50aadd4\",\"notes\":\"\",\"repeat\":{\"su\":false,\"m\":true,\"t\":true,\"w\":true,\"th\":true,\"f\":true,\"s\":true},\"streak\":7,\"tags\":{},\"text\":\"Prendre le courrier\",\"type\":\"daily\",\"value\":5.666723474273019},\"c7bcbefb-4396-42f7-b92f-aa057aca967c\":{\"completed\":false,\"history\":[{\"date\":1373457008211,\"value\":1},{\"date\":1373557619829,\"value\":1.9747},{\"date\":1373615215983,\"value\":2.9253562257358428},{\"date\":1373701273068,\"value\":1.9975792058131296},{\"date\":1373792923066,\"value\":2.9476782325960302},{\"date\":1373870037119,\"value\":3.8749247031542176},{\"date\":1373961068360,\"value\":4.780398384346655},{\"date\":1374045889768,\"value\":5.665104000405978}],\"id\":\"c7bcbefb-4396-42f7-b92f-aa057aca967c\",\"notes\":\"\",\"repeat\":{\"su\":true,\"m\":true,\"t\":true,\"w\":true,\"th\":true,\"f\":true,\"s\":true},\"streak\":4,\"tags\":{},\"text\":\"Lavage de dents du soir\",\"type\":\"daily\",\"value\":5.665104000405978},\"ccea02ac-e7b6-48d1-af6c-ecce10935a6d\":{\"completed\":false,\"id\":\"ccea02ac-e7b6-48d1-af6c-ecce10935a6d\",\"notes\":\"\",\"tags\":{},\"text\":\"Harvest\",\"type\":\"todo\",\"value\":-5.273878399739519},\"cde90815-0524-40e6-8dcb-e7b1ad35b637\":{\"completed\":false,\"id\":\"cde90815-0524-40e6-8dcb-e7b1ad35b637\",\"notes\":\"\",\"priority\":\"!!!\",\"tags\":{},\"text\":\"Appeler les salles de mariage\",\"type\":\"todo\",\"value\":-3.079244230667636},\"cfd3bbf1-3b18-4ddf-b69e-7283b83db0bc\":{\"completed\":false,\"id\":\"cfd3bbf1-3b18-4ddf-b69e-7283b83db0bc\",\"type\":\"todo\",\"text\":\"Changer joints de salle de bain\",\"notes\":\"\",\"value\":0,\"tags\":{}},\"de288769-df70-45b5-b9b4-51bd427d03bd\":{\"completed\":false,\"id\":\"de288769-df70-45b5-b9b4-51bd427d03bd\",\"notes\":\"\",\"tags\":{},\"text\":\"Recycler téléphone SAGEM\",\"type\":\"todo\",\"value\":-3.079244230667636},\"dec20a0b-f190-462b-8cf5-1b8756ea12d8\":{\"completed\":true,\"id\":\"dec20a0b-f190-462b-8cf5-1b8756ea12d8\",\"text\":\"Prendre rendez vous dentiste\",\"type\":\"todo\",\"value\":-5.239802699145147},\"e4209eee-9b22-4cf5-adf3-d6b9992fc16b\":{\"completed\":true,\"history\":[{\"date\":1373457008211,\"value\":1},{\"date\":1373557619829,\"value\":1.9747},{\"date\":1373615215983,\"value\":1.024043774264157},{\"date\":1373701273068,\"value\":1.998143412564751},{\"date\":1373792923066,\"value\":2.9482287028135716},{\"date\":1373870037119,\"value\":3.8754620936318465},{\"date\":1373961068360,\"value\":4.780923305699728},{\"date\":1374045889768,\"value\":5.665617021312497}],\"id\":\"e4209eee-9b22-4cf5-adf3-d6b9992fc16b\",\"streak\":6,\"text\":\"Se peser\",\"type\":\"daily\",\"value\":6.5304796989028775},\"ead3b1e9-3940-4f98-b11d-b8abd153c7bc\":{\"completed\":false,\"id\":\"ead3b1e9-3940-4f98-b11d-b8abd153c7bc\",\"notes\":\"\",\"priority\":\"!!\",\"tags\":{},\"text\":\"Ecrire article Battle 3 vs 3\",\"type\":\"todo\",\"value\":-8.812292068721371},\"f1deaa31-e00d-4214-8049-c7c643f4d7b1\":{\"down\":true,\"history\":[{\"date\":1373457009158,\"value\":1}],\"id\":\"f1deaa31-e00d-4214-8049-c7c643f4d7b1\",\"text\":\"Manger un plat picard\",\"type\":\"habit\",\"up\":true,\"value\":1},\"fba2d020-1eeb-47a7-a620-086135938856\":{\"completed\":true,\"id\":\"fba2d020-1eeb-47a7-a620-086135938856\",\"notes\":\"\",\"priority\":\"!!!\",\"tags\":{},\"text\":\"Laver la salle de bain du haut\",\"type\":\"todo\",\"value\":-4.129174475435185}},\"todoIds\":[\"18188c1a-f91d-4cab-a9e1-5c7250c12002\",\"3330c614-875d-4ec0-a77e-eb7721e0c61c\",\"57f9b235-f074-452f-b171-870c382bf0c7\",\"4264ea64-f55b-4a48-82a3-ae89f174aa67\",\"5d746132-6363-42b2-a414-490c39f576ac\",\"78e33fae-839f-4293-b85f-3417a1120db5\",\"cde90815-0524-40e6-8dcb-e7b1ad35b637\",\"dec20a0b-f190-462b-8cf5-1b8756ea12d8\",\"7b2f0c9f-00fb-4788-a27e-d4cab21afdb7\",\"ccea02ac-e7b6-48d1-af6c-ecce10935a6d\",\"ead3b1e9-3940-4f98-b11d-b8abd153c7bc\",\"2180602f-055c-47f3-b7a7-e0b04a550f41\",\"fba2d020-1eeb-47a7-a620-086135938856\",\"de288769-df70-45b5-b9b4-51bd427d03bd\",\"a03998ce-63f6-451a-ba89-15ec36cff717\",\"5605735d-de8a-4d45-8aa5-d9207ee12692\",\"8e139638-ce8f-40ba-8d00-beff78fb9a54\",\"2c0014ad-b27e-4147-8a77-ca89a8e2d086\",\"5a97b15e-d836-4384-983a-97fb59c0e3c0\",\"af292882-6971-456a-829a-8c4ec4c369c5\",\"86ea029c-68ee-4aa6-a3fe-e5277a2e952c\",\"72109429-9696-4788-83bf-0281536f0e87\",\"beaa3751-04e8-4b0e-b9b3-df3f300afd15\",\"196a06c8-7860-42fa-a6a5-575819292690\",\"2c1f35b7-bb3a-4785-b362-b838e697d212\",\"30ea1718-fde1-4529-bdef-de9c59a5f0bf\",\"cfd3bbf1-3b18-4ddf-b69e-7283b83db0bc\",\"628f2374-9139-42ad-bfa9-b046527b6b36\",\"abf6c28c-4368-486c-b04f-9b87b3bb38f1\",\"8da807e7-133b-44ae-8c65-8d1210e1fc83\"],\"id\":\"b3848424-9ac3-438d-8172-095a3c5dda04\"}";

    private ObjectMapper mapper = new ObjectMapper();

    @Test
    public void should_unmarshall_user() throws IOException {
        User user = mapper.readValue(response, User.class);

        assertThat(user.getAuth().getTimestamps().getLoggedIn().getTime()).isEqualTo(1374097074972L);

        Filters filters = user.getFilters();
        assertThat(filters).isNotNull();

        assertThat(user.getFlags().isCustomizationsNotification()).isTrue();
        assertThat(user.getFlags().isDropsEnabled()).isTrue();

        Collection<Egg> eggs = user.getItems().getEggs();

        Iterator<Egg> iterator = eggs.iterator();
        iterator.next();
        Egg egg = iterator.next();
        assertThat(egg.getType()).isEqualTo(Egg.Type.Egg);
        assertThat(egg.getText()).isEqualTo("Wolf");
        assertThat(egg.getName()).isEqualTo("Wolf");
        assertThat(egg.getValue()).isEqualTo(3);
        assertThat(egg.getNotes()).isEqualTo("Find a hatching potion to pour on this egg, and one day it will hatch into a loyal pet.");
        assertThat(egg.getDialog()).isEqualTo("You've found a Wolf Egg! Find a hatching potion to pour on this egg, and one day it will hatch into a loyal pet.");

        Drop drop = user.getItems().getLastDrop();
        assertThat(drop.getDate().getTime()).isEqualTo(1374060986295L);
        assertThat(drop.getCount()).isEqualTo(3);

        Profile profile = user.getProfile();
        assertThat(profile.getImageUrl()).isEmpty();
        assertThat(profile.getName()).isEqualTo("Julien Smadja");
        assertThat(profile.getWebsites().iterator().next()).isEqualTo("http://www.neogeodb.com");

    }

}
