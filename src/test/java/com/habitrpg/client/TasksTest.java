package com.habitrpg.client;

import com.habitrpg.client.resource.Task;
import org.codehaus.jackson.map.ObjectMapper;
import org.codehaus.jackson.map.type.SimpleType;
import org.codehaus.jackson.type.JavaType;
import org.junit.Test;

import java.io.IOException;
import java.util.List;

import static org.codehaus.jackson.map.type.CollectionType.construct;

public class TasksTest {

    private String response = "[{\"down\":true,\"history\":[{\"date\":1373480976639,\"value\":1},{\"date\":1374002858957,\"value\":1.9747}],\"id\":\"0dc6b10d-ca72-4325-8ece-918b27dfab78\",\"text\":\"Aller au sport\",\"type\":\"habit\",\"up\":true,\"value\":1.9747},{\"completed\":false,\"id\":\"18188c1a-f91d-4cab-a9e1-5c7250c12002\",\"type\":\"todo\",\"text\":\"Bugs neogeodb\",\"notes\":\"\",\"value\":0,\"tags\":{}},{\"completed\":true,\"id\":\"196a06c8-7860-42fa-a6a5-575819292690\",\"notes\":\"\",\"priority\":\"!!\",\"tags\":{},\"text\":\"Finir Halo 3\",\"type\":\"todo\",\"value\":-3.0488181170434947},{\"completed\":false,\"id\":\"2180602f-055c-47f3-b7a7-e0b04a550f41\",\"notes\":\"\",\"tags\":{},\"text\":\"Aero Fighters 2\",\"type\":\"todo\",\"value\":-3.079244230667636},{\"down\":true,\"history\":[{\"date\":1373919001148,\"value\":1},{\"date\":1374061011523,\"value\":1.9747}],\"id\":\"2a24c069-483d-48b9-8a4c-80a7f7b22d3f\",\"text\":\"Manger un plat pas calorique\",\"type\":\"habit\",\"up\":true,\"value\":1.9747},{\"completed\":true,\"id\":\"2c0014ad-b27e-4147-8a77-ca89a8e2d086\",\"notes\":\"\",\"tags\":{},\"text\":\"Real Bout Fatal Fury Special\",\"type\":\"todo\",\"value\":0.025956704627064786},{\"completed\":true,\"id\":\"2c1f35b7-bb3a-4785-b362-b838e697d212\",\"notes\":\"\",\"tags\":{},\"text\":\"Aller voir Mauléon\",\"type\":\"todo\",\"value\":0.025956704627064786},{\"completed\":false,\"id\":\"30ea1718-fde1-4529-bdef-de9c59a5f0bf\",\"notes\":\"\",\"priority\":\"!!!\",\"tags\":{},\"text\":\"Karcheriser le balcon\",\"type\":\"todo\",\"value\":-8.812292068721371},{\"completed\":false,\"id\":\"3330c614-875d-4ec0-a77e-eb7721e0c61c\",\"type\":\"todo\",\"text\":\"Ajouter video ChallegerOfTheWorves\",\"notes\":\"\",\"value\":0,\"tags\":{}},{\"completed\":true,\"id\":\"4264ea64-f55b-4a48-82a3-ae89f174aa67\",\"type\":\"todo\",\"text\":\"Créer invit déj Benjamin\",\"notes\":\"\",\"value\":1,\"tags\":{}},{\"down\":true,\"history\":[{\"date\":1373708277052,\"value\":1},{\"date\":1373713382248,\"value\":1.9747},{\"date\":1374061016723,\"value\":2.9253562257358428}],\"id\":\"4bfd013f-41f2-4f88-b72c-1a93036c4034\",\"notes\":\"\",\"tags\":{},\"text\":\"Litière\",\"type\":\"habit\",\"up\":true,\"value\":2.9253562257358428},{\"completed\":true,\"history\":[{\"date\":1374045889768,\"value\":1}],\"id\":\"5354befd-7e82-4210-8ffd-44c13a3b7b2e\",\"notes\":\"\",\"repeat\":{\"su\":true,\"m\":true,\"t\":true,\"w\":true,\"th\":true,\"f\":true,\"s\":true},\"streak\":2,\"tags\":{},\"text\":\"< 68 Kg\",\"type\":\"daily\",\"value\":1.9747},{\"completed\":false,\"id\":\"5605735d-de8a-4d45-8aa5-d9207ee12692\",\"notes\":\"\",\"tags\":{},\"text\":\"King of Fighters '01\",\"type\":\"todo\",\"value\":-4.161348258391507},{\"completed\":false,\"id\":\"56f8260f-2abe-4936-a2d1-5e6fc3228863\",\"type\":\"todo\",\"text\":\"Prendre RDV dermato\",\"notes\":\"\",\"value\":0,\"tags\":{}},{\"completed\":false,\"id\":\"57f9b235-f074-452f-b171-870c382bf0c7\",\"type\":\"todo\",\"text\":\"Prévoir déj Paali\",\"notes\":\"\",\"value\":0,\"tags\":{}},{\"completed\":true,\"id\":\"5a97b15e-d836-4384-983a-97fb59c0e3c0\",\"type\":\"todo\",\"text\":\"Real Bout Fatal Fury\",\"notes\":\"\",\"value\":1,\"tags\":{}},{\"completed\":false,\"id\":\"5d746132-6363-42b2-a414-490c39f576ac\",\"type\":\"todo\",\"text\":\"Prévoir déj Ludwine\",\"notes\":\"\",\"value\":0,\"tags\":{}},{\"completed\":true,\"id\":\"628f2374-9139-42ad-bfa9-b046527b6b36\",\"notes\":\"\",\"tags\":{},\"text\":\"Vendre ou donner la TV cathodique 55cm\",\"type\":\"todo\",\"value\":-3.0488181170434947},{\"down\":true,\"history\":[{\"date\":1373708269889,\"value\":1},{\"date\":1373710547160,\"value\":1.9747},{\"date\":1373976493668,\"value\":2.9253562257358428}],\"id\":\"638df483-f8e5-4f9f-a576-62af6951471b\",\"notes\":\"\",\"tags\":{},\"text\":\"Descendre poubelle\",\"type\":\"habit\",\"up\":true,\"value\":2.9253562257358428},{\"completed\":true,\"history\":[{\"date\":1373870037114,\"value\":1},{\"date\":1373961068360,\"value\":1.9747},{\"date\":1374045889768,\"value\":2.9253562257358428}],\"id\":\"6b135068-c1a1-43d8-9fa1-4d7efda2df9b\",\"notes\":\"\",\"repeat\":{\"su\":false,\"m\":true,\"t\":true,\"w\":true,\"th\":true,\"f\":true,\"s\":false},\"streak\":4,\"tags\":{},\"text\":\"Se lever à 7h30\",\"type\":\"daily\",\"value\":3.853133245658556},{\"completed\":true,\"id\":\"72109429-9696-4788-83bf-0281536f0e87\",\"text\":\"Remplir la feuille de soins\",\"type\":\"todo\",\"value\":-3.0488181170434947},{\"completed\":true,\"id\":\"78e33fae-839f-4293-b85f-3417a1120db5\",\"type\":\"todo\",\"text\":\"Créer accès staffing ludwine\",\"notes\":\"\",\"value\":1,\"tags\":{}},{\"completed\":true,\"id\":\"7b2f0c9f-00fb-4788-a27e-d4cab21afdb7\",\"notes\":\"\",\"tags\":{},\"text\":\"Prendre RDV chez Bouet le 18\",\"type\":\"todo\",\"value\":-5.239802699145147},{\"completed\":true,\"id\":\"86ea029c-68ee-4aa6-a3fe-e5277a2e952c\",\"text\":\"Prendre rendez vous coiffeur\",\"type\":\"todo\",\"value\":-3.0488181170434947},{\"completed\":true,\"id\":\"8da807e7-133b-44ae-8c65-8d1210e1fc83\",\"text\":\"Pneu clio 3\",\"type\":\"todo\",\"value\":0.025956704627064786},{\"completed\":false,\"id\":\"8e139638-ce8f-40ba-8d00-beff78fb9a54\",\"notes\":\"\",\"tags\":{},\"text\":\"King of Fighters '97\",\"type\":\"todo\",\"value\":-4.161348258391507},{\"completed\":false,\"id\":\"a03998ce-63f6-451a-ba89-15ec36cff717\",\"text\":\"Changer pile de ma montre\",\"type\":\"todo\",\"value\":-8.812292068721371},{\"completed\":true,\"id\":\"abf6c28c-4368-486c-b04f-9b87b3bb38f1\",\"text\":\"Trier vide poche\",\"type\":\"todo\",\"value\":0.025956704627064786},{\"completed\":false,\"history\":[{\"date\":1373457008210,\"value\":1},{\"date\":1373557619829,\"value\":1.9747},{\"date\":1373615215983,\"value\":2.9253562257358428},{\"date\":1373701273067,\"value\":3.853133245658556},{\"date\":1373792923066,\"value\":4.779421276212302},{\"date\":1373870037115,\"value\":5.664149044631875},{\"date\":1373961068360,\"value\":6.529044256984443},{\"date\":1374045889768,\"value\":7.374981304009736}],\"id\":\"adb5c005-585e-4312-bf1d-432e9d1f6f60\",\"notes\":\"\",\"repeat\":{\"su\":true,\"m\":true,\"t\":true,\"w\":true,\"th\":true,\"f\":true,\"s\":true},\"streak\":8,\"tags\":{},\"text\":\"Creme le soir\",\"type\":\"daily\",\"value\":7.374981304009736},{\"completed\":true,\"id\":\"af292882-6971-456a-829a-8c4ec4c369c5\",\"notes\":\"\",\"tags\":{},\"text\":\"Jeter le Dell XPS\",\"type\":\"todo\",\"value\":-3.0488181170434947},{\"completed\":true,\"history\":[{\"date\":1373457008210,\"value\":-1},{\"date\":1373557619829,\"value\":0.025956704627064786},{\"date\":1373615215983,\"value\":-0.9733783617683589},{\"date\":1373701273068,\"value\":0.05187867997035989},{\"date\":1373792923066,\"value\":1.050550143672086},{\"date\":1373870037115,\"value\":2.0239883589663585},{\"date\":1373961068360,\"value\":2.9734446246898476},{\"date\":1374045889768,\"value\":2.046810192411606}],\"id\":\"bddf09e3-784d-4a95-8cda-6709b694e37a\",\"streak\":1,\"text\":\"Creme le matin\",\"type\":\"daily\",\"value\":2.995711357575025},{\"completed\":true,\"id\":\"beaa3751-04e8-4b0e-b9b3-df3f300afd15\",\"notes\":\"\",\"priority\":\"!!\",\"tags\":{},\"text\":\"Ranger mon armoire\",\"type\":\"todo\",\"value\":-3.0488181170434947},{\"completed\":true,\"history\":[{\"date\":1373457008210,\"value\":1},{\"date\":1373557619829,\"value\":1.9747},{\"date\":1373615215983,\"value\":2.9253562257358428},{\"date\":1373701273068,\"value\":3.853133245658556},{\"date\":1373792923066,\"value\":4.759112700885761},{\"date\":1373870037115,\"value\":5.6443010177121415},{\"date\":1373961068360,\"value\":6.5096362419810205},{\"date\":1374045889768,\"value\":7.355994112832055}],\"id\":\"bf27f3e2-a315-4765-a9c3-aa9b0fd939ea\",\"notes\":\"\",\"repeat\":{\"su\":true,\"m\":true,\"t\":true,\"w\":true,\"th\":true,\"f\":true,\"s\":true},\"streak\":9,\"tags\":{},\"text\":\"Effexor à midi\",\"type\":\"daily\",\"value\":8.184193475367},{\"completed\":true,\"history\":[{\"date\":1373457008211,\"value\":-1},{\"date\":1373557619829,\"value\":0.025956704627064786},{\"date\":1373615215983,\"value\":1.0252917710224885},{\"date\":1373701273068,\"value\":1.999360257529945},{\"date\":1373792923066,\"value\":2.949415922378421},{\"date\":1373870037119,\"value\":2.949415922378421},{\"date\":1373961068360,\"value\":3.87662110426386},{\"date\":1374045889768,\"value\":4.7820554242776065}],\"id\":\"c5c0c35f-a850-4ddc-9cba-9057d50aadd4\",\"notes\":\"\",\"repeat\":{\"su\":false,\"m\":true,\"t\":true,\"w\":true,\"th\":true,\"f\":true,\"s\":true},\"streak\":7,\"tags\":{},\"text\":\"Prendre le courrier\",\"type\":\"daily\",\"value\":5.666723474273019},{\"completed\":false,\"history\":[{\"date\":1373457008211,\"value\":1},{\"date\":1373557619829,\"value\":1.9747},{\"date\":1373615215983,\"value\":2.9253562257358428},{\"date\":1373701273068,\"value\":1.9975792058131296},{\"date\":1373792923066,\"value\":2.9476782325960302},{\"date\":1373870037119,\"value\":3.8749247031542176},{\"date\":1373961068360,\"value\":4.780398384346655},{\"date\":1374045889768,\"value\":5.665104000405978}],\"id\":\"c7bcbefb-4396-42f7-b92f-aa057aca967c\",\"notes\":\"\",\"repeat\":{\"su\":true,\"m\":true,\"t\":true,\"w\":true,\"th\":true,\"f\":true,\"s\":true},\"streak\":4,\"tags\":{},\"text\":\"Lavage de dents du soir\",\"type\":\"daily\",\"value\":5.665104000405978},{\"completed\":false,\"id\":\"ccea02ac-e7b6-48d1-af6c-ecce10935a6d\",\"notes\":\"\",\"tags\":{},\"text\":\"Harvest\",\"type\":\"todo\",\"value\":-5.273878399739519},{\"completed\":false,\"id\":\"cde90815-0524-40e6-8dcb-e7b1ad35b637\",\"notes\":\"\",\"priority\":\"!!!\",\"tags\":{},\"text\":\"Appeler les salles de mariage\",\"type\":\"todo\",\"value\":-3.079244230667636},{\"completed\":false,\"id\":\"cfd3bbf1-3b18-4ddf-b69e-7283b83db0bc\",\"type\":\"todo\",\"text\":\"Changer joints de salle de bain\",\"notes\":\"\",\"value\":0,\"tags\":{}},{\"completed\":false,\"id\":\"de288769-df70-45b5-b9b4-51bd427d03bd\",\"notes\":\"\",\"tags\":{},\"text\":\"Recycler téléphone SAGEM\",\"type\":\"todo\",\"value\":-3.079244230667636},{\"completed\":true,\"id\":\"dec20a0b-f190-462b-8cf5-1b8756ea12d8\",\"text\":\"Prendre rendez vous dentiste\",\"type\":\"todo\",\"value\":-5.239802699145147},{\"completed\":true,\"history\":[{\"date\":1373457008211,\"value\":1},{\"date\":1373557619829,\"value\":1.9747},{\"date\":1373615215983,\"value\":1.024043774264157},{\"date\":1373701273068,\"value\":1.998143412564751},{\"date\":1373792923066,\"value\":2.9482287028135716},{\"date\":1373870037119,\"value\":3.8754620936318465},{\"date\":1373961068360,\"value\":4.780923305699728},{\"date\":1374045889768,\"value\":5.665617021312497}],\"id\":\"e4209eee-9b22-4cf5-adf3-d6b9992fc16b\",\"streak\":6,\"text\":\"Se peser\",\"type\":\"daily\",\"value\":6.5304796989028775},{\"completed\":false,\"id\":\"ead3b1e9-3940-4f98-b11d-b8abd153c7bc\",\"notes\":\"\",\"priority\":\"!!\",\"tags\":{},\"text\":\"Ecrire article Battle 3 vs 3\",\"type\":\"todo\",\"value\":-8.812292068721371},{\"down\":true,\"history\":[{\"date\":1373457009158,\"value\":1}],\"id\":\"f1deaa31-e00d-4214-8049-c7c643f4d7b1\",\"text\":\"Manger un plat picard\",\"type\":\"habit\",\"up\":true,\"value\":1},{\"completed\":true,\"id\":\"fba2d020-1eeb-47a7-a620-086135938856\",\"notes\":\"\",\"priority\":\"!!!\",\"tags\":{},\"text\":\"Laver la salle de bain du haut\",\"type\":\"todo\",\"value\":-4.129174475435185}]";

    @Test
    public void should_unmarshall_user() throws IOException {
        JavaType javaType = construct(List.class, SimpleType.construct(Task.class));
        new ObjectMapper().readValue(response, javaType);
    }
}
